import{t as x}from"./themeChart-df325d8f.js";import{m as C}from"./api-0c0121c1.js";import{n as z}from"./index-beda625d.js";let p="path://M1705.06,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705.06,1318.313z";const S={name:"blockCenter",mixins:[x],components:{},data(){return{svgIcon:p,mapInited:!1,legend:["Normal","Yaw"],chartData:{alladcode:[],geoJson:{},visualMapColors:[$c.cyA16,$c.cbA17,$c.blA18],nav:{data:[{code:21e4,name:this.$t("map.navRoot")}],position:{top:20,left:30}},lineData:[],planeData:[],planeDangerData:[],layoutCenter:[["50%","66%"],["50%","50%"]],layoutSize:["100%","80%"]},chartOption:{update:!1},clickData:{show:!1,area:"北京",data:"325",x:120,y:120}}},computed:{publicUrl(){return`./static/maps/${this.globalConfig.language}/`},mapCenter(){const{chartData:e}=this,{layoutCenter:a}=e;return e.nav.data[e.nav.data.length-1].name=="全国"?a[0]:a[1]},mapSize(){const{chartData:e}=this,{layoutSize:a}=e;return e.nav.data[e.nav.data.length-1].name=="全国"?a[0]:a[1]}},methods:{processMapData(e){const{chartData:a,chartOption:s,processTimeLine:r}=this,{lineData:i,planeData:o,planeDangerData:n,navDept:t}=a;s.series=[{name:" Top3",type:"lines",zlevel:2,symbol:["none","circle"],symbolSize:10,silent:!0,dimensions:["lng","lat"],effect:{show:!1,period:6,trailLength:0,symbol:p,symbolSize:30},lineStyle:{color:$c.fade("wh",.5),width:1},data:i},{type:"scatter",symbol:p,silent:!0,dimensions:["lng","lat"],symbolRotate:l=>l[3]-90,coordinateSystem:"geo",label:{show:!1},itemStyle:{color:{type:"radial",x:.3,y:.3,r:.5,colorStops:[{offset:0,color:$c.yel1},{offset:1,color:$c.yel6}],global:!1}},symbolSize:20,data:o,zlevel:5},{type:"scatter",symbol:p,symbolRotate:l=>l[3]-90,coordinateSystem:"geo",symbolOffset:[0,-10],label:{show:!1},itemStyle:{color:{type:"radial",x:.3,y:.3,r:.5,colorStops:[{offset:0,color:$c.rel3},{offset:1,color:$c.rel5}],global:!1}},symbolSize:24,emphasis:{scale:1.5},data:n,zlevel:5}],this.mapInited=!0},processOption(e){if(!e){let t=this.chartData.nav.data;e=t[t.length-1]}const{mapCenter:a,mapSize:s,chartOption:r,processMapData:i,getColor:o}=this;let n={title:{show:!1,text:e.name,left:"center"},geo:{type:"map",map:e.name,roam:!0,scaleLimit:{min:.5,max:5},layoutCenter:a,layoutSize:s,zlevel:1,label:{show:!0,color:o("actFC"),fontSize:12,formatter:t=>{switch(t.name){case"内蒙古自治区":t.name="内蒙古";break;case"西藏自治区":t.name="西藏";break;case"新疆维吾尔自治区":t.name="新疆";break;case"宁夏回族自治区":t.name="宁夏";break;case"广西壮族自治区":t.name="广西";break;case"香港特别行政区":t.name="香港";break;case"澳门特别行政区":t.name="澳门";break}return t.name}},itemStyle:{borderColor:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:o("mapBDA")},{offset:1,color:o("mapBDB")}],!1),borderWidth:1,shadowColor:o("mapSD"),shadowOffsetY:0,shadowBlur:20,areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(o("mapBGA"),.5)},{offset:1,color:$c.fade(o("mapBGB"),.5)}]}},emphasis:{label:{color:o("actFCS"),fontSize:14,show:!0},itemStyle:{areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(o("mapBGHA"),.5)},{offset:1,color:$c.fade(o("mapBGHB"),.5)}]}}}},series:[]};for(let t in n)r[t]=n[t];r.update=!0,i(e)},getMapData(e){const{chartData:a,processOption:s}=this;let r=[],i=[],o=[];a.geoJson.features.forEach((n,t)=>{a.geoJson.features.forEach((l,m)=>{let h=(Math.random()*500).toFixed(0);if(n.properties.center&&l.properties.center&&n.properties.name&&l.properties.name&&n.properties.name!=l.properties.name){let v=function(b,_,w,$){return Math.atan2($-_,w-b)*180/Math.PI};t==0&&r.push({coords:[n.properties.center,l.properties.center],fromName:n.properties.name,toName:l.properties.name,value:h});let d=n.properties.center[0],f=n.properties.center[1],y=l.properties.center[0],g=l.properties.center[1],c=Math.random(),u=(1-c)*d+c*y,D=(1-c)*f+c*g;t==0&&i.push({name:`${n.properties.name}-${l.properties.name}`,value:[u,D,h,v(d,f,y,g)],cityCode:parseInt(n.properties.adcode)}),t==this.randomNumber(1,3)&&m==this.randomNumber(1,10)&&o.push({name:`${n.properties.name}-${l.properties.name}`,value:[u,D,h,v(d,f,y,g)],cityCode:parseInt(n.properties.adcode)})}})}),a.lineData=r,a.planeData=i,a.planeDangerData=o,s(e)},async initChart(e){const{chartData:a,getMapData:s}=this;a.alladcode.length==0&&await C(this.publicUrl,"all.json").then(r=>{a.alladcode=r}).catch(function(r){console.error("getmap",r)}),await C(this.publicUrl,e.code+"_geojson_full.json").then(r=>{a.geoJson={...r,...e}}).catch(function(r){console.error("getmap",r)}),s(e)},mapAction(e){const{clickData:a}=this;a.show=!1},mapClick(e){var n;const{clickData:a}=this,{alladcode:s,initChart:r,nav:i}=this.chartData,o=i.data;if(a.show=!1,o[o.length-1].name!=e.name)if(e.componentType=="geo"){let t=(n=s.filter(m=>m.name===e.name)[0])==null?void 0:n.adcode,l={code:t,name:e.name};o[o.length-1].name!=e.name&&o.length<2&&(this.initChart(l),o.push({code:t,name:e.name}))}else e.code&&this.initChart(e);e.componentType=="series"&&(a.area=e.name,a.data=e.data.value[2],a.x=e.domPosition[0],a.y=e.domPosition[1],a.show=!0)},dataRefresh(){const{chartData:e,$timer:a}=this;a("refreshData",()=>{this.initChart(e.nav.data[e.nav.data.length-1]),this.dataRefresh()},5e3)}},mounted(){const{chartData:e}=this;this.initChart(e.nav.data[0]),this.dataRefresh()},beforeDestroy(){const{$timer:e}=this;e("refreshData")},destroyed(){}};var k=function(){var a=this,s=a._self._c;return s("div",{staticClass:"map-wrap map-plane"},[s("div",{staticClass:"legend"},a._l(a.legend,function(r,i){return s("div",{class:`item item-${i}`},[s("i",{staticClass:"svgIcon"}),s("span",{staticClass:"desc"},[a._v(a._s(r))])])}),0),a.mapInited?s("echartsMap",{staticClass:"echartMap",attrs:{chartOption:a.chartOption,chartData:a.chartData},on:{mapClick:a.mapClick,mapAction:a.mapAction}}):a._e()],1)},M=[],A=z(S,k,M,!1,null,null,null,null);const P=A.exports;export{P as default};
