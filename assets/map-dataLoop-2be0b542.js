import{n as y,_ as C}from"./index-e5c47b2c.js";import{t as D}from"./themeChart-df325d8f.js";import{m as f}from"./api-0c0121c1.js";const b={name:"blockCenter",mixins:[D],components:{mapFlowInfo:()=>C(()=>import("./map-flowInfo-af0d5955.js"),["assets/map-flowInfo-af0d5955.js","assets/index-e5c47b2c.js","assets/index-ff56af40.css","assets/map-flowInfo-be5469f9.css"])},data(){return{mapInited:!1,chartData:{alladcode:[],geoJson:{},colors:[$c.aql4,$c.cyl4,$c.rel4],mapData:[],pointData:[],timeLine:{title:["上海市","云南省","内蒙古","北京市","台湾省","吉林省","四川省","宁夏","安徽省","山东省","山西省","广东省","广西","新疆","江苏省","江西省","河北省","河南省","浙江省","海南省","湖北省","湖南省","澳门","甘肃省","福建省","西藏","贵州省","辽宁省","重庆市","陕西省","青海省","香港","黑龙江省"],titleType:"geoTitle",show:!1,x:0,y:0,dataGroup:{name:"",data:[{name:"计划完成情况",value:"57%"},{name:"年度完成矿次",value:117},{name:"文书数量",value:302},{name:"隐患数量",value:423}]}},sum:0,nav:{data:[{code:1e5,name:"全国"}],position:{top:80,left:30}},maxData:500,minData:9,maxPin:45,minPin:20,layoutCenter:[["50%","60%"],["50%","50%"]],layoutSize:["100%","80%"]},chartOption:{update:!1},clickData:{show:!1,area:"北京",data:"325",x:120,y:120}}},computed:{publicUrl(){return"./maps/"},mapCenter(){const{chartData:e}=this,{layoutCenter:t}=e;return e.nav.data[e.nav.data.length-1].name=="全国"?t[0]:t[1]},mapSize(){const{chartData:e}=this,{layoutSize:t}=e;return e.nav.data[e.nav.data.length-1].name=="全国"?t[0]:t[1]}},methods:{processMapData(e){const{chartData:t,chartOption:n,processTimeLine:l}=this,{mapData:o,pointData:s,sum:a,maxData:c,minData:h,maxPin:r,minPin:p}=t;n.series=[{symbolSize:5,emphasis:{label:{show:!1}},label:{formatter:i=>{switch(i.data.name){case"内蒙古自治区":i.data.name="内蒙古";break;case"西藏自治区":i.data.name="西藏";break;case"新疆维吾尔自治区":i.data.name="新疆";break;case"宁夏回族自治区":i.data.name="宁夏";break;case"广西壮族自治区":i.data.name="广西";break;case"香港特别行政区":i.data.name="香港";break;case"澳门特别行政区":i.data.name="澳门";break}return`
`+i.data.name},formatter:i=>{var m,d;return(d=(m=i.data)==null?void 0:m.name)==null?void 0:d.replace(/省|壮族自治区|回族自治区|维吾尔自治区|自治区|市|县|自治县|特别行政区|区/,"")},position:"center",align:"center",show:!1,color:$c.wh,fontSize:12},symbolOffset:[0,-10],itemStyle:{color:"#fff"},name:"light",type:"scatter",coordinateSystem:"geo",zlevel:2,data:s},{type:"scatter",symbol:"pin",coordinateSystem:"geo",symbolOffset:[0,-10],large:!0,label:{show:!0,position:"inside",align:"center",color:$c.bll7,fontSize:10,formatter:i=>i.data.value[2]},itemStyle:{color:{type:"radial",x:.5,y:.4,r:.5,colorStops:[{offset:0,color:$c.aql3},{offset:1,color:$c.cyl5}],global:!1}},emphasis:{label:{fontSize:14,color:$c.bll9,fontWeight:"bold",formatter:function(i){return i.data.value[2]}}},symbolSize:i=>{var m=(r-p)/(c-h),d=r-m*h;return d=r-m*c,m*i[2]+d*1.3},data:s,zlevel:2}];let u={currentIndex:0,domPosition:[1130.1332353810647,349.92544318277885]};this.mapTimeLineChanged(u),this.mapInited=!0},processOption(e){if(!e){let r=this.chartData.nav.data;e=r[r.length-1]}const{mapCenter:t,mapSize:n,chartData:l,chartOption:o,processMapData:s,getColor:a}=this,{timeLine:c}=l;let h={tooltip:{show:!0,formatter:function(r){return r.name+"<br />"+r.value[2]}},timeline:{data:c.title,axisType:"category",autoPlay:!0,playInterval:8e3,left:"center",bottom:"30",width:"50%",height:130,label:{position:"bottom",interval:0,backgroundColor:$c.fade($c.rel5,0),overflow:"breakAll",width:16,height:100,verticalAlign:"top",align:"center",fontSize:14,color:a("staFC"),formatter:r=>r==null?void 0:r.replace(/省|壮族自治区|回族自治区|维吾尔自治区|自治区|市|县|自治县|特别行政区|区/,"")},itemStyle:{color:a("techDecoB"),borderColor:a("techDecoB")},symbolSize:12,lineStyle:{color:a("techDecoB")},checkpointStyle:{borderColor:a("techDecoA"),color:a("techDecoA"),borderWidth:2},controlStyle:{showNextBtn:!0,showPrevBtn:!0,color:a("techDecoA"),borderColor:a("techDecoA")},emphasis:{itemStyle:{color:a("techDecoB"),borderColor:a("techDecoB")},label:{show:!0,color:a("staFCS"),rotate:0,fontSize:16},controlStyle:{color:a("staFCS"),borderColor:a("staFCS")}},progress:{itemStyle:{color:a("staFCW"),borderColor:a("staFCW")},label:{fontSize:14,color:a("staFCW")},controlStyle:{color:a("staFCW"),borderColor:a("staFCW")},lineStyle:{color:a("staFCW")}},zlevel:10},title:{show:!1,text:e.name,left:"center"},geo:{type:"map",map:e.name,roam:!0,scaleLimit:{min:.5,max:3},layoutCenter:t,layoutSize:n,zlevel:1,label:{show:!0,color:a("actFC"),fontSize:12,formatter:r=>{var p;return(p=r==null?void 0:r.name)==null?void 0:p.replace(/省|壮族自治区|回族自治区|维吾尔自治区|自治区|市|县|自治县|特别行政区|区/,"")}},itemStyle:{borderColor:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:a("mapBDA")},{offset:1,color:a("mapBDB")}],!1),borderWidth:1,shadowColor:a("mapSD"),shadowOffsetY:0,shadowBlur:20,areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(a("mapBGA"),.5)},{offset:1,color:$c.fade(a("mapBGB"),.5)}]}},emphasis:{label:{color:a("actFCS"),fontSize:14,show:!0},itemStyle:{areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(a("mapBGHA"),.5)},{offset:1,color:$c.fade(a("mapBGHB"),.5)}]}}}},series:[]};for(let r in h)o[r]=h[r];o.update=!0,s(e)},getMapData(e){const{chartData:t,processOption:n}=this;let l=[],o=[],s=0;t.geoJson.features.forEach(a=>{if(a.properties.name){let c=(Math.random()*500).toFixed(0);l.push({name:a.properties.name,value:c,cityCode:parseInt(a.properties.adcode)}),a.properties.center&&o.push({name:a.properties.name,value:[a.properties.center[0],a.properties.center[1],c],cityCode:parseInt(a.properties.adcode)}),s+=c}}),t.mapData=l,t.pointData=o,t.sum=s,n(e)},async initChart(e){const{chartData:t,getMapData:n}=this,{timeLine:l}=t;t.alladcode.length==0&&await f(this.publicUrl,"all.json").then(o=>{t.alladcode=o}).catch(function(o){console.error("getmap",o)}),await f(this.publicUrl,e.code+"_geojson_full.json").then(o=>{t.geoJson={...o,...e};let s=[];o.features.forEach(a=>{a.properties.name&&s.push(a.properties.name)}),l.title=s}).catch(function(o){console.error("getmap",o)}),n(e)},processTimeLine(e){const{timeLine:t}=this.chartData;let n=t.title[e.currentIndex];t.dataGroup.name;let l=t.dataGroup.data;n||(n=e.name),t.dataGroup.name=n+"煤监局",l.forEach((o,s)=>{s==0?o.value=Math.round(Math.random()*80+20)+"%":o.value=Math.round(Math.random()*800)})},mapAction(e){const{timeLine:t}=this.chartData;t.show=!1},mapTimeLineChanged(e){const{timeLine:t,alladcode:n}=this.chartData;t.show=!1,t.x=e.domPosition[0],t.y=e.domPosition[1],this.processTimeLine(e),t.show=!0},mapClick(e){const{alladcode:t,initChart:n,nav:l,timeLine:o}=this.chartData;if(l.data[l.data.length-1].name!=e.name){if(e.componentType=="geo"){o.show=!1;let s=t.filter(c=>c.name===e.name)[0].adcode,a={code:s,name:e.name};l.data[l.data.length-1].name!=e.name&&(this.initChart(a),l.data.push({code:s,name:e.name}))}else e.componentType=="mapNav"&&this.initChart(e);e.componentType!="timeline"&&(o.show=!1)}e.componentType=="series"&&(o.show=!1,o.x=e.domPosition[0],o.y=e.domPosition[1],this.processTimeLine(e),o.show=!0)}},mounted(){const{chartData:e}=this;this.initChart(e.nav.data[0])},beforeDestroy(){},destroyed(){}};var v=function(){var t=this,n=t._self._c;return n("div",{staticClass:"map-wrap map-dataLoop"},[t.mapInited?n("echartsMap",{staticClass:"echartMap",attrs:{chartOption:t.chartOption,chartData:t.chartData},on:{mapClick:t.mapClick,mapAction:t.mapAction,mapTimeLineChanged:t.mapTimeLineChanged}}):t._e(),t.chartData.timeLine.show?n("mapFlowInfo",{attrs:{timeLine:t.chartData.timeLine}}):t._e()],1)},g=[],S=y(b,v,g,!1,null,null,null,null);const x=S.exports;export{x as default};
