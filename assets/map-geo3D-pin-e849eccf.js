import{n as v,_ as f}from"./index-beda625d.js";import{t as _}from"./themeChart-df325d8f.js";import{m as g}from"./api-0c0121c1.js";const w={mixins:[_],components:{mapPopover:()=>f(()=>import("./map-popover-af4ada01.js"),["assets/map-popover-af4ada01.js","assets/index-beda625d.js","assets/index-c2c9ef50.css","assets/map-popover-e2ab1a87.css"]),mapViewToggle:()=>f(()=>import("./map-viewToggle-a8da7b60.js"),["assets/map-viewToggle-a8da7b60.js","assets/index-beda625d.js","assets/index-c2c9ef50.css","assets/map-viewToggle-13399c52.css"])},data(){return{mapInited:!1,view:{data:[{title:"矿山分布",label:"data1"},{title:"执法完成",label:"data2"},{title:"风险分布",label:"data3"},{title:"区域分布",label:"data4"}],current:"data1"},chartData:{alladcode:[],geoJson:{},visualMapColors:[$c.cyA16,$c.cbA17,$c.blA18],mapData:[],pointData:[],sum:0,nav:{data:[{code:21e4,name:this.$t("map.navRoot")}],show:!1},maxData:500,minData:9,maxPin:55,minPin:10,layoutCenter:[["50%","66%"],["50%","50%"]],layoutSize:["100%","80%"],visualMapPos:{right:"13%",bottom:"8.5%"},regions:[]},chartOption:{update:!1},clickData:{show:!1,area:"北京",data:"325",x:120,y:120}}},computed:{publicUrl(){return`./static/maps/${this.globalConfig.language}/`},pinColor(){const{view:a}=this;if(a.current=="data1")return[$c.aql2,$c.aql5,$c.bll7];if(a.current=="data2")return[$c.cbl3,$c.cyl5,$c.wh];if(a.current=="data3")return[$c.orl3,$c.rel5,$c.wh];if(a.current=="data4")return[$c.pul3,$c.inl6,$c.wh]},mapCenter(){const{chartData:a}=this,{layoutCenter:t}=a;return a.nav.data[a.nav.data.length-1].name=="全国"?t[0]:t[1]},mapSize(){const{chartData:a}=this,{layoutSize:t}=a;return a.nav.data[a.nav.data.length-1].name=="全国"?t[0]:t[1]}},watch:{},methods:{changeView(a){let t=this.chartData.nav.data;this.view.current=a.label,this.clickData.show=!1,this.getMapData(t[t.length-1])},processMapData(a){const{chartData:t,chartOption:s,processTimeLine:r,getColor:l}=this,{mapData:c,pointData:i,sum:m,navDept:p,maxData:o,minData:e,maxPin:d,minPin:D}=t;let b=[];b.push({name:"bar3D",type:"bar3D",coordinateSystem:"geo3D",barSize:.3,shading:"lambert",opacity:1,bevelSize:10,bevelSmoothness:10,label:{show:!1,formatter:"{b}"},data:i},{type:"scatter3D",coordinateSystem:"geo3D",zlevel:90,geo3DIndex:0,shading:"lambert",blendMode:"lighter",symbol:"circle",symbolSize:n=>{var h=(d-D)/(o-e),u=d-h*e;return u=d-h*o,[h*n[3]+u*1,h*n[3]+u*1.3]},label:{show:!0,position:"top",distance:0,color:l("staFCS"),borderRadius:3,fontSize:14,padding:3,backgroundColor:$c.fade("bk",.6),fontSize:14,formatter:n=>{switch(n.name){case"内蒙古自治区":n.name="内蒙古";break;case"西藏自治区":n.name="西藏";break;case"新疆维吾尔自治区":n.name="新疆";break;case"宁夏回族自治区":n.name="宁夏";break;case"广西壮族自治区":n.name="广西";break;case"香港特别行政区":n.name="香港";break;case"澳门特别行政区":n.name="澳门";break}return n.name}},emphasis:{label:{fontSize:14,fontWeight:"bold",formatter:n=>n.data.value[3]}},itemStyle:{color:this.pinColor[1]},data:i}),s.series=b,this.mapInited=!0},processOption(a){if(!a){let e=this.chartData.nav.data;a=e[e.length-1]}const{mapCenter:t,mapSize:s,chartData:r,chartOption:l,processMapData:c,getColor:i}=this,{visualMapPos:m,regions:p}=r;let o={title:{show:!1,text:a.name,left:"center"},tooltip:{show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove"},geo3D:{map:a.name,roam:!1,boxHeight:10,boxWidth:200,bottom:0,regionHeight:4,environment:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:$c.cbA03},{offset:.9,color:$c.blA19},{offset:1,color:$c.blA19}],!1),regions:p,itemStyle:{color:$c.fade(i("mapBGA"),1),borderColor:i("mapBGB"),opacity:1,borderWidth:.5,shadowColor:i("mapSD")},instancing:!0,viewControl:{autoRotateAfterStill:13,minBeta:-180,maxBeta:180,center:[0,-50,-20],beta:5,alpha:50,distance:260,rotateMouseButton:"left",panMouseButton:"right",panSensitivity:1,animationDurationUpdate:1e3,animationEasingUpdate:"cubicInOut"},emphasis:{disabled:!0,label:{show:!0,color:i("staFCWr"),fontSize:16},itemStyle:{color:i("mapBGHA")}},label:{show:!1,position:"top",color:i("actFCS"),fontSize:14,distance:1,zlevel:0,formatter:e=>{switch(e.name){case"内蒙古自治区":e.name="内蒙古";break;case"西藏自治区":e.name="西藏";break;case"新疆维吾尔自治区":e.name="新疆";break;case"宁夏回族自治区":e.name="宁夏";break;case"广西壮族自治区":e.name="广西";break;case"香港特别行政区":e.name="香港";break;case"澳门特别行政区":e.name="澳门";break}return`
`+e.name}},light:{main:{color:"#fff",intensity:1,shadowQuality:"high",shadow:!0,shadowQuality:"medium",alpha:90,beta:10},ambient:{intensity:.7}}},series:[]};for(let e in o)l[e]=o[e];l.update=!0,c(a)},getMapData(a){const{chartData:t,processOption:s}=this;let r=[],l=[],c=0;t.geoJson.features.forEach(o=>{if(o.properties.name){let e=(Math.random()*500).toFixed(0);r.push({name:o.properties.name,value:e,cityCode:parseInt(o.properties.adcode)}),o.properties.center&&l.push({name:o.properties.name,value:[o.properties.center[0],o.properties.center[1],100,e],cityCode:parseInt(o.properties.adcode)}),c+=e}});let i=1,m=8,p=r.map(function(o){return{name:o.name,height:(Math.log(o.value)-i)/(m-i)*m}});t.regions=p,t.mapData=r,t.pointData=l,t.sum=c,s(a)},async initChart(a){const{chartData:t,getMapData:s}=this;t.alladcode.length==0&&await g(this.publicUrl,"all.json").then(r=>{t.alladcode=r}).catch(function(r){console.error("getmap",r)}),await g(this.publicUrl,a.code+"_geojson_full.json").then(r=>{t.geoJson={...r,...a}}).catch(function(r){console.error("getmap",r)}),s(a)},mapAction(a){const{clickData:t}=this;t.show=!1},mapHover(a){console.log("mapHover",a)},mapClick(a){const{clickData:t}=this,{alladcode:s,initChart:r,nav:l}=this.chartData;l.data,t.show=!1,console.log("click",a)},chartTheme(){let a=this.themePalette.chart.visual;this.chartData.visualMapColors=this.getPalette({total:10,actual:5,palette:a})}},mounted(){const{chartData:a}=this;this.initChart(a.nav.data[0])},beforeDestroy(){},destroyed(){}};var C=function(){var t=this,s=t._self._c;return s("div",{staticClass:"map-wrap map-geo3D-ping"},[s("mapPopover",{attrs:{clickData:t.clickData}}),t.mapInited?s("echartsMap",{staticClass:"echartsMap",attrs:{chartOption:t.chartOption,chartData:t.chartData},on:{mapClick:t.mapClick,mapHover:t.mapHover,mapAction:t.mapAction}}):t._e()],1)},y=[],k=v(w,C,y,!1,null,null,null,null);const M=k.exports;export{M as default};
