import{n as u,_ as h}from"./index-beda625d.js";import{t as f}from"./themeChart-df325d8f.js";import{m as d}from"./api-0c0121c1.js";const D={mixins:[f],components:{mapPopover:()=>h(()=>import("./map-popover-af4ada01.js"),["assets/map-popover-af4ada01.js","assets/index-beda625d.js","assets/index-c2c9ef50.css","assets/map-popover-e2ab1a87.css"]),mapViewToggle:()=>h(()=>import("./map-viewToggle-a8da7b60.js"),["assets/map-viewToggle-a8da7b60.js","assets/index-beda625d.js","assets/index-c2c9ef50.css","assets/map-viewToggle-13399c52.css"])},data(){return{mapInited:!1,view:{data:[{title:"矿山分布",label:"data1"},{title:"执法完成",label:"data2"},{title:"风险分布",label:"data3"},{title:"区域分布",label:"data4"}],current:"data1"},chartData:{alladcode:[],geoJson:{},visualMapColors:[$c.cyA16,$c.cbA17,$c.blA18],mapData:[],pointData:[],sum:0,nav:{data:[{code:21e4,name:this.$t("map.navRoot")}],show:!1},maxData:500,minData:9,maxPin:45,minPin:20,layoutCenter:[["50%","66%"],["50%","50%"]],layoutSize:["100%","80%"],visualMapPos:{right:"13%",bottom:"8.5%"}},chartOption:{update:!1},clickData:{show:!1,area:"北京",data:"325",x:120,y:120}}},computed:{publicUrl(){return`./static/maps/${this.globalConfig.language}/`},pinColor(){const{view:t}=this;if(t.current=="data1")return[$c.aql2,$c.aql5,$c.bll7];if(t.current=="data2")return[$c.cbl3,$c.cyl5,$c.wh];if(t.current=="data3")return[$c.orl3,$c.rel5,$c.wh];if(t.current=="data4")return[$c.pul3,$c.inl6,$c.wh]},mapCenter(){const{chartData:t}=this,{layoutCenter:e}=t;return t.nav.data[t.nav.data.length-1].name=="全国"?e[0]:e[1]},mapSize(){const{chartData:t}=this,{layoutSize:e}=t;return t.nav.data[t.nav.data.length-1].name=="全国"?e[0]:e[1]}},watch:{},methods:{changeView(t){let e=this.chartData.nav.data;this.view.current=t.label,this.clickData.show=!1,this.getMapData(e[e.length-1])},processMapData(t){const{getColor:e,chartData:i,chartOption:n,processTimeLine:s}=this,{mapData:o,pointData:r,sum:l,navDept:a,maxData:c,minData:_,maxPin:y,minPin:w}=i;let m=[];m.push({type:"lines3D",coordinateSystem:"geo3D",blendMode:"source-over",effect:{show:!0,trailWidth:6,trailOpacity:.8,trailLength:.2,constantSpeed:5},tooltip:{formatter:function(p){return"name:"+p.name+"<br />value:"+p.value[2]}},zlevel:1,geo3DIndex:0,silent:!0,emphasis:{label:{formatter:p=>p.data.value[2]}},itemStyle:{},data:o}),n.series=m,this.mapInited=!0},processOption(t){if(!t){let a=this.chartData.nav.data;t=a[a.length-1]}const{mapCenter:e,mapSize:i,chartData:n,chartOption:s,processMapData:o,getColor:r}=this;let l={title:{show:!1,text:t.name,left:"center"},tooltip:{show:!0},geo3D:{map:t.name,roam:!1,boxHeight:30,boxWidth:200,bottom:0,regionHeight:4,regions:[{name:"山西省",height:5,itemStyle:{color:"red"}}],realisticMaterial:{detailTexture:"#666",textureTiling:1,metalness:0,roughness:.5},itemStyle:{color:$c.fade(r("mapBGA"),.3),borderColor:r("mapBGB"),opacity:.5,borderWidth:.4,shadowColor:r("mapSD")},instancing:!0,viewControl:{autoRotateAfterStill:13,minBeta:-180,maxBeta:180,center:[0,-50,-20],beta:5,alpha:50,distance:260,rotateMouseButton:"left",panMouseButton:"right",panSensitivity:1,animationDurationUpdate:1e3,animationEasingUpdate:"cubicInOut"},emphasis:{disabled:!1,label:{show:!1,color:r("staFCWr"),fontSize:16},itemStyle:{color:r("mapBGHA")}},label:{show:!0,position:"top",color:r("actFCS"),fontSize:14,distance:10,zlevel:0,formatter:a=>{switch(a.name){case"内蒙古自治区":a.name="内蒙古";break;case"西藏自治区":a.name="西藏";break;case"新疆维吾尔自治区":a.name="新疆";break;case"宁夏回族自治区":a.name="宁夏";break;case"广西壮族自治区":a.name="广西";break;case"香港特别行政区":a.name="香港";break;case"澳门特别行政区":a.name="澳门";break}return`
`+a.name}},light:{main:{intensity:.8,shadow:!0,alpha:120,beta:80},ambient:{intensity:.6}}},series:[]};for(let a in l)s[a]=l[a];s.update=!0,o(t)},getMapData(t){const{chartData:e,processOption:i}=this;let n=[],s=this.colorPicker({total:67,actual:33,jump:0,palette:["#e61919","#f5f5a3","#19e680","#19e5e6","#197fe6"]});e.geoJson.features.forEach((o,r)=>{e.geoJson.features.forEach((l,a)=>{let c=(Math.random()*500).toFixed(0);o.properties.center&&l.properties.center&&o.properties.name&&l.properties.name&&o.properties.name!=l.properties.name&&r==0&&a<33&&n.push({coords:[o.properties.center,l.properties.center],fromName:o.properties.name,toName:l.properties.name,value:c,lineStyle:{color:s[a],width:2,opacity:.5}})})}),e.mapData=n,i(t)},async initChart(t){const{chartData:e,getMapData:i}=this;e.alladcode.length==0&&await d(this.publicUrl,"all.json").then(n=>{e.alladcode=n}).catch(function(n){console.error("getmap",n)}),await d(this.publicUrl,t.code+"_geojson_full.json").then(n=>{e.geoJson={...n,...t}}).catch(function(n){console.error("getmap",n)}),i(t)},mapOver(t){console.log("mapOver",t)},mapAction(t){const{clickData:e}=this;e.show=!1},mapClick(t){var r;const{clickData:e}=this,{alladcode:i,initChart:n,nav:s}=this.chartData,o=s.data;if(e.show=!1,o[o.length-1].name!=t.name)if(t.componentType=="geo"||t.componentType=="series"&&t.componentSubType=="map"){let l=(r=i.filter(c=>c.name===t.name)[0])==null?void 0:r.adcode,a={code:l,name:t.name};o[o.length-1].name!=t.name&&o.length<2&&(this.initChart(a),o.push({code:l,name:t.name}))}else t.code&&this.initChart(t);t.componentType=="series"&&t.componentSubType=="scatter"&&(e.area=t.name,e.data=t.data.value[2],e.x=t.domPosition[0],e.y=t.domPosition[1],e.show=!0)},chartTheme(){this.themePalette.chart.visual,this.chartData.visualMapColors=this.getPalette({total:3,actual:2,palette:[$c.bll5,$c.yel3,$c.rel5]})}},mounted(){const{chartData:t}=this;this.initChart(t.nav.data[0])},beforeDestroy(){},destroyed(){}};var g=function(){var e=this,i=e._self._c;return i("div",{staticClass:"map-wrap map3D-simple"},[i("mapPopover",{attrs:{clickData:e.clickData}}),e.mapInited?i("echartsMap",{staticClass:"echartsMap",attrs:{chartOption:e.chartOption,chartData:e.chartData},on:{mapClick:e.mapClick,mapOver:e.mapOver,mapAction:e.mapAction}}):e._e()],1)},v=[],b=u(D,g,v,!1,null,null,null,null);const k=b.exports;export{k as default};
