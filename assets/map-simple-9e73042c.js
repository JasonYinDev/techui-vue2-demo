import{n as D,_ as u}from"./index-beda625d.js";import{t as _}from"./themeChart-df325d8f.js";import{m as v}from"./api-0c0121c1.js";const y={mixins:[_],components:{mapPopover:()=>u(()=>import("./map-popover-130ca8aa.js"),["assets/map-popover-130ca8aa.js","assets/index-beda625d.js","assets/index-c2c9ef50.css","assets/map-popover-f75de9d4.css"]),mapNav:()=>u(()=>import("./map-nav-ce7fede4.js"),["assets/map-nav-ce7fede4.js","assets/index-beda625d.js","assets/index-c2c9ef50.css","assets/map-nav-09b0b525.css"]),mapCounter:()=>u(()=>import("./map-counter-1eea9e47.js"),["assets/map-counter-1eea9e47.js","assets/index-beda625d.js","assets/index-c2c9ef50.css","assets/map-counter-e1d51d3f.css"]),mapViewToggle:()=>u(()=>import("./map-viewToggle-58dc3c26.js"),["assets/map-viewToggle-58dc3c26.js","assets/index-beda625d.js","assets/index-c2c9ef50.css","assets/map-viewToggle-28a09cc2.css"])},data(){return{mapInited:!1,view:{data:[{title:"矿山分布",label:"data1"},{title:"执法完成",label:"data2"},{title:"风险分布",label:"data3"},{title:"区域分布",label:"data4"}],current:"data1"},chartData:{alladcode:[],geoJson:{},visualMapColors:[$c.cyA16,$c.cbA17,$c.blA18],mapData:[],pointData:[],sum:0,nav:{data:[{code:21e4,name:this.$t("map.navRoot")}],position:{bottom:"28%",left:"27.5%"}},maxData:500,minData:9,maxPin:45,minPin:20,layoutCenter:[["50%","60%"],["50%","45%"]],layoutSize:["80%","70%"],visualMapPos:{left:"27.5%",bottom:"32%"}},chartOption:{update:!1},clickData:{show:!1,area:"北京",data:"325",x:120,y:120}}},computed:{publicUrl(){return`./static/maps/${this.globalConfig.language}/`},pinColor(){const{view:t}=this;if(t.current=="data1")return[$c.aql2,$c.cyl5,$c.bll7];if(t.current=="data2")return[$c.cbl3,$c.bll5,$c.wh];if(t.current=="data3")return[$c.orl3,$c.rel5,$c.wh];if(t.current=="data4")return[$c.pul3,$c.inl6,$c.wh]},mapCenter(){const{chartData:t}=this,{layoutCenter:e}=t;return t.nav.data[t.nav.data.length-1].name=="全国"?e[0]:e[1]},mapSize(){const{chartData:t}=this,{layoutSize:e}=t;return t.nav.data[t.nav.data.length-1].name=="全国"?e[0]:e[1]}},watch:{},methods:{changeView(t){let e=this.chartData.nav.data;this.view.current=t.label,this.clickData.show=!1,this.getMapData(e[e.length-1])},processMapData(t){const{chartData:e,chartOption:o,processTimeLine:l}=this,{mapData:c,pointData:i,sum:a,navDept:n,maxData:s,minData:r,maxPin:m,minPin:g}=e;let f=[];this.view.current=="data4"?f.push({data:i,geoIndex:0,type:"map"}):f.push({symbolSize:5,emphasis:{label:{show:!1}},label:{formatter:p=>{var h,d;return(d=(h=p.data)==null?void 0:h.name)==null?void 0:d.replace(/省|壮族自治区|回族自治区|维吾尔自治区|自治区|市|县|自治县|特别行政区|区/,"")},position:"center",align:"center",show:!1,color:$c.wh,fontSize:12},symbolOffset:[0,-10],itemStyle:{color:"#fff"},name:"light",type:"scatter",coordinateSystem:"geo",zlevel:2,data:i},{type:"scatter",symbol:"pin",coordinateSystem:"geo",symbolOffset:[0,-10],large:!0,label:{show:!0,position:"inside",align:"center",color:this.pinColor[2],fontSize:10,formatter:p=>p.data.value[2]},emphasis:{label:{fontSize:14,color:this.pinColor[2],fontWeight:"bold",formatter:function(p){return p.data.value[2]}}},itemStyle:{color:{type:"radial",x:.3,y:.3,r:.5,colorStops:[{offset:0,color:this.pinColor[0]},{offset:1,color:this.pinColor[1]}],global:!0}},symbolSize:p=>{var h=(m-g)/(s-r),d=m-h*r;return d=m-h*s,h*p[2]+d*1.3},data:i,zlevel:2}),o.series=f,this.mapInited=!0},processOption(t){if(!t){let r=this.chartData.nav.data;t=r[r.length-1]}const{mapCenter:e,mapSize:o,chartData:l,chartOption:c,processMapData:i,getColor:a}=this,{visualMapPos:n}=l;let s={title:{show:!1,text:t.name,left:"center"},geo:{type:"map",map:t.name,roam:!0,scaleLimit:{min:.5,max:3},layoutCenter:e,layoutSize:o,zlevel:1,label:{show:!0,color:a("actFC"),fontSize:12,formatter:r=>{var m;return(m=r==null?void 0:r.name)==null?void 0:m.replace(/省|壮族自治区|回族自治区|维吾尔自治区|自治区|市|县|自治县|特别行政区|区/,"")}},itemStyle:{borderColor:a("mapBDB"),borderWidth:1,areaColor:{type:"linear-gradient",x:0,y:1e3,x2:1e3,y2:0,colorStops:[{offset:0,color:a("mapBGA")},{offset:1,color:a("mapBGB")}],global:!0}},select:{label:{color:a("actFCS"),fontSize:14},itemStyle:{areaColor:a("mapBGHA")}},emphasis:{label:{color:a("actFCS"),fontSize:14,show:!0},itemStyle:{areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(a("mapBGHA"),.5)},{offset:1,color:$c.fade(a("mapBGHB"),.5)}]}}}},series:[]};this.view.current=="data4"?s.visualMap={left:n.left,bottom:n.bottom,min:0,max:500,inRange:{color:l.visualMapColors},textStyle:{color:a("staFC")},calculable:!0}:s.visualMap=null;for(let r in s)c[r]=s[r];c.update=!0,i(t)},getMapData(t){const{chartData:e,processOption:o}=this;let l=[],c=[],i=0;e.geoJson.features.forEach(a=>{if(a.properties.name){let n=(Math.random()*500).toFixed(0);l.push({name:a.properties.name,value:n,cityCode:parseInt(a.properties.adcode)}),a.properties.center&&c.push({name:a.properties.name,value:[a.properties.center[0],a.properties.center[1],n],cityCode:parseInt(a.properties.adcode)}),i+=n}}),e.mapData=l,e.pointData=c,e.sum=i,o(t)},async initChart(t){const{chartData:e,getMapData:o}=this;e.alladcode.length==0&&await v(this.publicUrl,"all.json").then(l=>{e.alladcode=l}).catch(function(l){console.error("getmap",l)}),await v(this.publicUrl,t.code+"_geojson_full.json").then(l=>{e.geoJson={...l,...t}}).catch(function(l){console.error("getmap",l)}),o(t)},mapAction(t){const{clickData:e}=this;e.show=!1},mapClick(t){var a;const{clickData:e}=this,{alladcode:o,initChart:l,nav:c}=this.chartData,i=c.data;if(e.show=!1,console.log("params",t),i[i.length-1].name!=t.name)if(t.componentType=="geo"||t.componentType=="series"&&t.componentSubType=="map"){let n=(a=o.filter(r=>r.name===t.name)[0])==null?void 0:a.adcode,s={code:n,name:t.name};i[i.length-1].name!=t.name&&i.length<2&&(this.initChart(s),i.push({code:n,name:t.name}))}else t.code&&this.initChart(t);t.componentType=="series"&&t.componentSubType=="scatter"&&(e.area=t.name,e.data=t.data.value[2],e.x=t.domPosition[0],e.y=t.domPosition[1],e.show=!0)},chartTheme(){let t=this.themePalette.chart.visual;this.chartData.visualMapColors=this.getPalette({total:10,actual:5,palette:t})}},mounted(){const{chartData:t}=this;this.initChart(t.nav.data[0])},beforeDestroy(){},destroyed(){}};var b=function(){var e=this,o=e._self._c;return o("div",{staticClass:"dashboard1080pC-map"},[o("mapCounter"),o("mapPopover",{attrs:{clickData:e.clickData}}),o("mapViewToggle",{attrs:{view:e.view},on:{changeView:e.changeView}}),e.mapInited?o("echartsMap",{staticClass:"echartsMap",attrs:{chartOption:e.chartOption,chartData:e.chartData},on:{mapClick:e.mapClick,mapAction:e.mapAction}}):e._e()],1)},C=[],w=D(y,b,C,!1,null,null,null,null);const z=w.exports;export{z as default};
