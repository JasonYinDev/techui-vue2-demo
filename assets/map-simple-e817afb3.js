import{n as g,_ as u}from"./index-2766203e.js";import{t as b}from"./themeChart-df325d8f.js";import{m as v}from"./api-0c0121c1.js";const y={mixins:[b],components:{mapPopover:()=>u(()=>import("./map-popover-d61f4541.js"),["assets/map-popover-d61f4541.js","assets/index-2766203e.js","assets/index-ff56af40.css","assets/map-popover-f721a8b2.css"]),mapViewToggle:()=>u(()=>import("./map-viewToggle-147f3f0b.js"),["assets/map-viewToggle-147f3f0b.js","assets/index-2766203e.js","assets/index-ff56af40.css","assets/map-viewToggle-3cf6660a.css"])},data(){return{mapInited:!1,view:{data:[{title:"Data A",label:"data1"},{title:"Data B",label:"data2"},{title:"Data C",label:"data3"},{title:"Data D",label:"data4"}],current:"data1"},chartData:{alladcode:[],geoJson:{},visualMapColors:[$c.cyA16,$c.cbA17,$c.blA18],mapData:[],pointData:[],sum:0,nav:{data:[{code:21e4,name:this.$t("map.navRoot")}],position:{top:20,left:30}},maxData:500,minData:9,maxPin:45,minPin:20,layoutCenter:[["50%","66%"],["50%","50%"]],layoutSize:["100%","80%"],visualMapPos:{right:"13%",bottom:"8.5%"}},chartOption:{update:!1},clickData:{show:!1,area:"北京",data:"325",x:120,y:120}}},computed:{publicUrl(){return`./static/maps/${this.globalConfig.language}/`},pinColor(){const{view:a}=this;if(a.current=="data1")return[$c.aql2,$c.cyl5,$c.bll7];if(a.current=="data2")return[$c.cbl3,$c.bll5,$c.wh];if(a.current=="data3")return[$c.orl3,$c.rel5,$c.wh];if(a.current=="data4")return[$c.pul3,$c.inl6,$c.wh]},mapCenter(){const{chartData:a}=this,{layoutCenter:t}=a;return a.nav.data[a.nav.data.length-1].name=="全国"?t[0]:t[1]},mapSize(){const{chartData:a}=this,{layoutSize:t}=a;return a.nav.data[a.nav.data.length-1].name=="全国"?t[0]:t[1]}},watch:{},methods:{changeView(a){let t=this.chartData.nav.data;this.view.current=a.label,this.clickData.show=!1,this.getMapData(t[t.length-1])},processMapData(a){const{chartData:t,chartOption:r,processTimeLine:i}=this,{mapData:c,pointData:l,sum:e,navDept:n,maxData:s,minData:o,maxPin:d,minPin:D}=t;let f=[];this.view.current=="data4"?f.push({data:l,geoIndex:0,type:"map"}):f.push({symbolSize:5,emphasis:{label:{show:!1}},label:{formatter:p=>{var m,h;return(h=(m=p.data)==null?void 0:m.name)==null?void 0:h.replace(/省|壮族自治区|回族自治区|维吾尔自治区|自治区|市|县|自治县|特别行政区|区/,"")},position:"center",align:"center",show:!1,color:$c.wh,fontSize:12},symbolOffset:[0,-10],itemStyle:{color:"#fff"},name:"light",type:"scatter",coordinateSystem:"geo",zlevel:2,data:l},{type:"scatter",symbol:"pin",coordinateSystem:"geo",symbolOffset:[0,-10],large:!0,label:{show:!0,position:"inside",align:"center",color:this.pinColor[2],fontSize:10,formatter:p=>p.data.value[2]},emphasis:{label:{fontSize:14,color:this.pinColor[2],fontWeight:"bold",formatter:function(p){return p.data.value[2]}}},itemStyle:{color:{type:"radial",x:.3,y:.3,r:.5,colorStops:[{offset:0,color:this.pinColor[0]},{offset:1,color:this.pinColor[1]}],global:!1}},symbolSize:p=>{var m=(d-D)/(s-o),h=d-m*o;return h=d-m*s,m*p[2]+h*1.3},data:l,zlevel:2}),r.series=f,this.mapInited=!0},processOption(a){if(!a){let o=this.chartData.nav.data;a=o[o.length-1]}const{mapCenter:t,mapSize:r,chartData:i,chartOption:c,processMapData:l,getColor:e}=this,{visualMapPos:n}=i;let s={title:{show:!1,text:a.name,left:"center"},geo:{type:"map",map:a.name,roam:!0,scaleLimit:{min:.5,max:3},layoutCenter:t,layoutSize:r,zlevel:1,label:{show:!0,color:e("actFC"),fontSize:12,formatter:o=>{switch(o.name){case"内蒙古自治区":o.name="内蒙古";break;case"西藏自治区":o.name="西藏";break;case"新疆维吾尔自治区":o.name="新疆";break;case"宁夏回族自治区":o.name="宁夏";break;case"广西壮族自治区":o.name="广西";break;case"香港特别行政区":o.name="香港";break;case"澳门特别行政区":o.name="澳门";break}return o.name}},itemStyle:{borderColor:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:e("mapBDB")},{offset:1,color:e("mapBDB")}],!1),borderWidth:1,shadowColor:e("mapSD"),shadowOffsetY:0,shadowBlur:10,areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(e("mapBGA"),.5)},{offset:1,color:$c.fade(e("mapBGB"),.5)}]}},select:{label:{color:e("actFCS"),fontSize:14},itemStyle:{areaColor:e("mapBGHA")}},emphasis:{label:{color:e("actFCS"),fontSize:14,show:!0},itemStyle:{areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(e("mapBGHA"),.5)},{offset:1,color:$c.fade(e("mapBGHB"),.5)}]}}}},series:[]};this.view.current=="data4"?s.visualMap={right:n.right,bottom:n.bottom,min:0,max:500,inRange:{color:i.visualMapColors},textStyle:{color:e("staFC")},calculable:!0}:s.visualMap=null;for(let o in s)c[o]=s[o];c.update=!0,l(a)},getMapData(a){const{chartData:t,processOption:r}=this;let i=[],c=[],l=0;t.geoJson.features.forEach(e=>{if(e.properties.name){let n=(Math.random()*500).toFixed(0);i.push({name:e.properties.name,value:n,cityCode:parseInt(e.properties.adcode)}),e.properties.center&&c.push({name:e.properties.name,value:[e.properties.center[0],e.properties.center[1],n],cityCode:parseInt(e.properties.adcode)}),l+=n}}),t.mapData=i,t.pointData=c,t.sum=l,r(a)},async initChart(a){const{chartData:t,getMapData:r}=this;t.alladcode.length==0&&await v(this.publicUrl,"all.json").then(i=>{t.alladcode=i}).catch(function(i){console.error("getmap",i)}),await v(this.publicUrl,a.code+"_geojson_full.json").then(i=>{t.geoJson={...i,...a}}).catch(function(i){console.error("getmap",i)}),r(a)},mapAction(a){const{clickData:t}=this;t.show=!1},mapClick(a){var e;const{clickData:t}=this,{alladcode:r,initChart:i,nav:c}=this.chartData,l=c.data;if(t.show=!1,l[l.length-1].name!=a.name)if(a.componentType=="geo"||a.componentType=="series"&&a.componentSubType=="map"){let n=(e=r.filter(o=>o.name===a.name)[0])==null?void 0:e.adcode,s={code:n,name:a.name};l[l.length-1].name!=a.name&&l.length<2&&(this.initChart(s),l.push({code:n,name:a.name}))}else a.code&&this.initChart(a);a.componentType=="series"&&a.componentSubType=="scatter"&&(t.area=a.name,t.data=a.data.value[2],t.x=a.domPosition[0],t.y=a.domPosition[1],t.show=!0)},chartTheme(){let a=this.themePalette.chart.visual;this.chartData.visualMapColors=this.getPalette({total:10,actual:5,palette:a})}},mounted(){const{chartData:a}=this;this.initChart(a.nav.data[0])},beforeDestroy(){},destroyed(){}};var C=function(){var t=this,r=t._self._c;return r("div",{staticClass:"map-wrap map-simple"},[r("mapPopover",{attrs:{clickData:t.clickData}}),r("mapViewToggle",{attrs:{view:t.view},on:{changeView:t.changeView}}),t.mapInited?r("echartsMap",{staticClass:"echartsMap",attrs:{chartOption:t.chartOption,chartData:t.chartData},on:{mapClick:t.mapClick,mapAction:t.mapAction}}):t._e()],1)},_=[],w=g(y,C,_,!1,null,null,null,null);const z=w.exports;export{z as default};
