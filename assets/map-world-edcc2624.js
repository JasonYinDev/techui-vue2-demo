import{n as b,_ as v}from"./index-2766203e.js";import{t as g}from"./themeChart-df325d8f.js";import{m as y}from"./api-0c0121c1.js";const w={mixins:[g],components:{mapPopover:()=>v(()=>import("./map-popover-d61f4541.js"),["assets/map-popover-d61f4541.js","assets/index-2766203e.js","assets/index-ff56af40.css","assets/map-popover-f721a8b2.css"]),mapViewToggle:()=>v(()=>import("./map-viewToggle-147f3f0b.js"),["assets/map-viewToggle-147f3f0b.js","assets/index-2766203e.js","assets/index-ff56af40.css","assets/map-viewToggle-3cf6660a.css"])},data(){return{mapInited:!1,view:{data:[{title:"Data A",label:"data1"},{title:"Data B",label:"data2"},{title:"Data C",label:"data3"},{title:"Data D",label:"data4"}],current:"data1"},chartData:{alladcode:[],geoJson:{},visualMapColors:[$c.cyA16,$c.cbA17,$c.blA18],mapData:[],pointData:[],sum:0,nav:{data:[{code:0,name:"World"}],show:!1},maxData:500,minData:9,maxPin:45,minPin:20,layoutCenter:["50%","50%"],layoutSize:"140%",visualMapPos:{right:"13%",bottom:"8.5%"}},chartOption:{update:!1},clickData:{show:!1,area:"北京",data:"325",x:120,y:120}}},computed:{publicUrl(){return"./static/maps/"},pinColor(){const{view:a}=this;if(a.current=="data1")return[$c.aql2,$c.cyl5,$c.bll7];if(a.current=="data2")return[$c.cbl3,$c.bll5,$c.wh];if(a.current=="data3")return[$c.orl3,$c.rel5,$c.wh];if(a.current=="data4")return[$c.pul3,$c.inl6,$c.wh]}},watch:{},methods:{changeView(a){let t=this.chartData.nav.data;this.view.current=a.label,this.clickData.show=!1,this.getMapData(t[t.length-1])},processMapData(a){const{chartData:t,chartOption:s,processTimeLine:r,getColor:e}=this,{mapData:n,pointData:o,sum:p,navDept:i,maxData:l,minData:h,maxPin:c,minPin:u}=t;let d=[];this.view.current=="data4"?d.push({data:o,geoIndex:0,type:"map"}):d.push({symbolSize:5,label:{position:"center",align:"center",show:!0,color:$c.fade(e("staFCS"),.3),fontSize:12,formatter:function(m){return m.data.name}},emphasis:{label:{show:!0,fontSize:14,color:e("staFCS"),fontWeight:"bold"}},symbolOffset:[0,-10],itemStyle:{color:"#fff"},name:"light",type:"scatter",coordinateSystem:"geo",zlevel:2,data:o},{type:"scatter",symbol:"pin",coordinateSystem:"geo",symbolOffset:[0,-10],large:!0,label:{show:!0,position:"inside",align:"center",color:this.pinColor[2],fontSize:10,formatter:m=>m.data.value[2]},emphasis:{label:{show:!0,fontSize:14,color:this.pinColor[2],fontWeight:"bold"}},itemStyle:{color:{type:"radial",x:.3,y:.3,r:.5,colorStops:[{offset:0,color:this.pinColor[0]},{offset:1,color:this.pinColor[1]}],global:!1}},symbolSize:m=>{var f=(c-u)/(l-h),D=c-f*h;return D=c-f*l,f*m[2]+D*1.3},data:o,zlevel:2}),s.series=d,this.mapInited=!0},processOption(a){if(!a){let l=this.chartData.nav.data;a=l[l.length-1]}const{chartData:t,chartOption:s,processMapData:r,getColor:e}=this,{visualMapPos:n,layoutCenter:o,layoutSize:p}=t;let i={title:{show:!1,text:a.name,left:"center"},geo:{type:"map",map:a.name,roam:!0,scaleLimit:{min:.5,max:10},layoutCenter:o,layoutSize:p,zlevel:1,label:{show:!1,color:e("actFC"),fontSize:12},itemStyle:{borderColor:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:e("mapBDB")},{offset:1,color:e("mapBDB")}],!1),borderWidth:2,shadowColor:e("mapSD"),shadowOffsetY:0,shadowBlur:10,areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(e("mapBGA"),.5)},{offset:1,color:$c.fade(e("mapBGB"),.5)}]}},select:{label:{color:e("actFCS"),fontSize:14},itemStyle:{areaColor:e("mapBGHA")}},emphasis:{label:{color:e("actFCS"),fontSize:14,show:!1},itemStyle:{areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(e("mapBGHA"),.5)},{offset:1,color:$c.fade(e("mapBGHB"),.5)}]}}}},series:[]};this.view.current=="data4"?i.visualMap={right:n.right,bottom:n.bottom,min:0,max:500,inRange:{color:t.visualMapColors},textStyle:{color:e("staFC")},calculable:!0}:i.visualMap=null;for(let l in i)s[l]=i[l];s.update=!0,r(a)},getMapData(a){const{chartData:t,processOption:s}=this;let r=[],e=[],n=0;t.geoJson.features.forEach((o,p)=>{if(o.properties.name){let i=(Math.random()*500).toFixed(0);r.push({name:o.properties.name,value:i,cityCode:parseInt(o.properties.adcode)}),o.properties.label_x&&e.push({name:o.properties.name,value:[o.properties.label_x,o.properties.label_y,i],cityCode:parseInt(o.properties.adcode)}),n+=i}}),t.mapData=r,t.pointData=e,t.sum=n,s(a)},async initChart(a){const{chartData:t,getMapData:s}=this;await y(this.publicUrl,"world.json").then(r=>{t.alladcode=r,t.geoJson=r,t.geoJson.code=0,t.geoJson.name="World"}).catch(function(r){console.error("getmap",r)}),await y(this.publicUrl,"world-china.json").then(r=>{let e=t.geoJson,n=r,o=[],p=[],i=[];n.features.forEach((l,h)=>{p.push(l.properties.name),e.features.forEach((c,u)=>{l.properties.name==c.properties.name_zh&&(l.properties=c.properties,o.push(l.properties.name))})}),e.features.forEach((l,h)=>{i.push(l.properties.name_zh)})}).catch(function(r){console.error("getmap",r)}),s(a)},mapAction(a){const{clickData:t}=this;t.show=!1},mapClick(a){const{clickData:t}=this,{alladcode:s,initChart:r,nav:e}=this.chartData;e.data,t.show=!1,a.componentType=="series"&&a.componentSubType=="scatter"&&(t.area=a.name,t.data=a.data.value[2],t.x=a.domPosition[0],t.y=a.domPosition[1],t.show=!0)},chartTheme(){let a=this.themePalette.chart.visual;this.chartData.visualMapColors=this.getPalette({total:10,actual:5,palette:a})}},mounted(){const{chartData:a}=this;this.initChart(a.nav.data[0])},beforeDestroy(){},destroyed(){}};var _=function(){var t=this,s=t._self._c;return s("div",{staticClass:"map-wrap map-simple"},[s("mapPopover",{attrs:{clickData:t.clickData}}),s("mapViewToggle",{attrs:{view:t.view},on:{changeView:t.changeView}}),t.mapInited?s("echartsMap",{staticClass:"echartsMap",attrs:{chartOption:t.chartOption,chartData:t.chartData},on:{mapClick:t.mapClick,mapAction:t.mapAction}}):t._e()],1)},C=[],S=b(w,_,C,!1,null,null,null,null);const A=S.exports;export{A as default};
