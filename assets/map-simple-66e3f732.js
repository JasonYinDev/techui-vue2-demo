import{n as _,_ as d}from"./index-e5c47b2c.js";import{t as v}from"./themeChart-df325d8f.js";import{m as u}from"./api-0c0121c1.js";const g={mixins:[v],components:{mapPopover:()=>d(()=>import("./map-popover-4c8d28ab.js"),["assets/map-popover-4c8d28ab.js","assets/index-e5c47b2c.js","assets/index-ff56af40.css","assets/map-popover-5cd4225b.css"]),mapNav:()=>d(()=>import("./map-nav-08d0b509.js"),["assets/map-nav-08d0b509.js","assets/index-e5c47b2c.js","assets/index-ff56af40.css","assets/map-nav-dbf7aa33.css"]),mapCounter:()=>d(()=>import("./map-counter-7e83b7ef.js"),["assets/map-counter-7e83b7ef.js","assets/index-e5c47b2c.js","assets/index-ff56af40.css","assets/map-counter-dbb016c1.css"]),mapViewToggle:()=>d(()=>import("./map-viewToggle-e5f4cd2f.js"),["assets/map-viewToggle-e5f4cd2f.js","assets/index-e5c47b2c.js","assets/index-ff56af40.css","assets/map-viewToggle-4f953f86.css"])},data(){return{mapInited:!1,view:{data:[{title:"矿山分布",label:"data1"},{title:"执法完成",label:"data2"},{title:"风险分布",label:"data3"}],current:"data1"},chartData:{alladcode:[],geoJson:{},visualMapColors:[$c.cyA16,$c.cbA17,$c.blA18],mapData:[],pointData:[],sum:0,nav:{data:[{code:21e4,name:this.$t("map.navRoot")}],position:{top:5,left:15}},maxData:500,minData:9,maxPin:35,minPin:15,layoutCenter:[["50%","50%"],["50%","45%"]],layoutSize:["90%","80%"]},chartOption:{update:!1},clickData:{show:!1,area:"北京",data:"325",x:120,y:120}}},computed:{publicUrl(){return`./static/maps/${this.globalConfig.language}/`},pinColor(){const{view:t}=this;if(t.current=="data1")return[$c.aql2,$c.cyl5,$c.bll7];if(t.current=="data2")return[$c.cbl3,$c.bll5,$c.wh];if(t.current=="data3")return[$c.orl3,$c.rel5,$c.wh]},mapCenter(){const{chartData:t}=this,{layoutCenter:a}=t;return t.nav.data[t.nav.data.length-1].name=="全国"?a[0]:a[1]},mapSize(){const{chartData:t}=this,{layoutSize:a}=t;return t.nav.data[t.nav.data.length-1].name=="全国"?a[0]:a[1]}},methods:{changeView(t){let a=this.chartData.nav.data;this.view.current=t.label,this.clickData.show=!1,this.getMapData(a[a.length-1])},processMapData(t){const{chartData:a,chartOption:o,processTimeLine:n}=this,{mapData:s,pointData:i,sum:e,navDept:l,maxData:r,minData:c,maxPin:f,minPin:D}=a;o.series=[{symbolSize:5,emphasis:{label:{show:!1}},label:{formatter:p=>{var m,h;return(h=(m=p.data)==null?void 0:m.name)==null?void 0:h.replace(/省|壮族自治区|回族自治区|维吾尔自治区|自治区|市|县|自治县|特别行政区|区/,"")},position:"center",align:"center",show:!1,color:$c.wh,fontSize:12},symbolOffset:[0,-10],itemStyle:{color:"#fff"},name:"light",type:"scatter",coordinateSystem:"geo",zlevel:2,data:i},{type:"scatter",symbol:"pin",coordinateSystem:"geo",symbolOffset:[0,-10],large:!0,label:{show:!0,position:"inside",align:"center",color:this.pinColor[2],fontSize:8,formatter:p=>p.data.value[2]},emphasis:{label:{fontSize:10,color:this.pinColor[2],fontWeight:"bold",formatter:function(p){return p.data.value[2]}}},itemStyle:{color:{type:"radial",x:.3,y:.3,r:.5,colorStops:[{offset:0,color:this.pinColor[0]},{offset:1,color:this.pinColor[1]}],global:!1}},symbolSize:p=>{var m=(f-D)/(r-c),h=f-m*c;return h=f-m*r,m*p[2]+h*1.3},data:i,zlevel:2}],this.mapInited=!0},processOption(t){if(!t){let r=this.chartData.nav.data;t=r[r.length-1]}const{mapCenter:a,mapSize:o,chartData:n,chartOption:s,processMapData:i,getColor:e}=this;let l={title:{show:!1,text:t.name,left:"center"},geo:{type:"map",map:t.name,roam:!0,scaleLimit:{min:.5,max:3},layoutCenter:a,layoutSize:o,zlevel:1,label:{show:!0,color:e("actFC"),fontSize:12,formatter:r=>{var c;return(c=r==null?void 0:r.name)==null?void 0:c.replace(/省|壮族自治区|回族自治区|维吾尔自治区|自治区|市|县|自治县|特别行政区|区/,"")}},itemStyle:{borderColor:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:e("mapBDA")},{offset:1,color:e("mapBDB")}],!1),borderWidth:1,shadowColor:e("mapSD"),shadowOffsetY:0,shadowBlur:20,areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(e("mapBGA"),.5)},{offset:1,color:$c.fade(e("mapBGB"),.5)}]}},emphasis:{label:{color:e("actFCS"),fontSize:14,show:!0},itemStyle:{areaColor:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:$c.fade(e("mapBGHA"),.5)},{offset:1,color:$c.fade(e("mapBGHB"),.5)}]}}}},series:[]};for(let r in l)s[r]=l[r];s.update=!0,i(t)},getMapData(t){const{chartData:a,processOption:o}=this;let n=[],s=[],i=0;a.geoJson.features.forEach(e=>{if(e.properties.name){let l=(Math.random()*500).toFixed(0);n.push({name:e.properties.name,value:l,cityCode:parseInt(e.properties.adcode)}),e.properties.center&&s.push({name:e.properties.name,value:[e.properties.center[0],e.properties.center[1],l],cityCode:parseInt(e.properties.adcode)}),i+=l}}),a.mapData=n,a.pointData=s,a.sum=i,o(t)},async initChart(t){const{chartData:a,getMapData:o}=this;a.alladcode.length==0&&await u(this.publicUrl,"all.json").then(n=>{a.alladcode=n}).catch(function(n){console.error("getmap",n)}),await u(this.publicUrl,t.code+"_geojson_full.json").then(n=>{a.geoJson={...n,...t}}).catch(function(n){console.error("getmap",n)}),o(t)},mapAction(t){const{clickData:a}=this;a.show=!1},mapClick(t){var e;const{clickData:a}=this,{alladcode:o,initChart:n,nav:s}=this.chartData,i=s.data;if(a.show=!1,i[i.length-1].name!=t.name)if(t.componentType=="geo"){let l=(e=o.filter(c=>c.name===t.name)[0])==null?void 0:e.adcode,r={code:l,name:t.name};i[i.length-1].name!=t.name&&i.length<2&&(this.initChart(r),i.push({code:l,name:t.name}))}else t.code&&this.initChart(t);t.componentType=="series"&&(a.area=t.name,a.data=t.data.value[2],a.x=t.domPosition[0],a.y=t.domPosition[1],a.show=!0)}},mounted(){const{chartData:t}=this;this.initChart(t.nav.data[0])},beforeDestroy(){},destroyed(){}};var y=function(){var a=this,o=a._self._c;return o("div",{staticClass:"dashboardMobileA-map"},[o("mapPopover",{attrs:{clickData:a.clickData}}),o("mapViewToggle",{attrs:{view:a.view},on:{changeView:a.changeView}}),a.mapInited?o("echartsMap",{staticClass:"echartsMap",attrs:{chartOption:a.chartOption,chartData:a.chartData},on:{mapClick:a.mapClick,mapAction:a.mapAction}}):a._e()],1)},C=[],b=_(g,y,C,!1,null,null,null,null);const x=b.exports;export{x as default};
